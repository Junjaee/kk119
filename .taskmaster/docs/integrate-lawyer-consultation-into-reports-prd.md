# PRD: 신고 접수 시스템 내 변호사 상담 통합

## 1. 프로젝트 개요

### 1.1 목적
교권119 시스템에서 독립적인 변호사 상담 게시판을 제거하고, 신고 접수 시스템 내에서 변호사 상담이 이루어지도록 통합하여 사용자 경험을 개선하고 시스템을 단순화한다.

### 1.2 배경
- 기존 변호사 상담 게시판의 활용도가 낮음
- 신고 접수와 변호사 상담이 분리되어 있어 사용자가 혼란을 겪음
- 신고 접수 후 변호사 상담이 필요한 경우가 많아 자연스러운 연결이 필요
- 시스템 복잡성 감소 및 사용성 향상 필요

### 1.3 범위
- **제거**: 독립적인 변호사 상담 게시판 (/consult 경로)
- **통합**: 신고 접수 시스템 내 변호사 상담 기능 구현
- **개선**: 신고 처리 프로세스에 변호사 상담 단계 추가
- **UI/UX**: 통합된 인터페이스 설계 및 구현

## 2. 현재 상태 분석

### 2.1 기존 시스템 구조
```
[신고 접수] → [검토] → [상담진행] → [해결완료]
     ↓
[변호사 상담 게시판] (독립적)
```

### 2.2 새로운 시스템 구조
```
[신고 접수] → [검토] → [변호사 상담 배정] → [상담진행] → [해결완료]
                              ↓
                      [변호사 응답 & 조치]
```

## 3. 기능 요구사항

### 3.1 신고 처리 프로세스 개선

#### 3.1.1 신고 상태 확장
기존 상태:
- `received` (접수완료)
- `reviewing` (검토중)
- `consulting` (상담진행)
- `completed` (해결완료)

추가 상태:
- `lawyer_assigned` (변호사 배정됨)
- `lawyer_consulting` (변호사 상담중)
- `lawyer_responded` (변호사 응답완료)

#### 3.1.2 변호사 배정 시스템
- 관리자가 신고 내역을 검토 후 변호사 상담 필요 여부 판단
- 변호사 상담이 필요한 경우 적절한 변호사에게 배정
- 변호사에게 알림 발송 (이메일 또는 시스템 내 알림)

### 3.2 변호사 대시보드 기능

#### 3.2.1 배정된 신고 목록
- 본인에게 배정된 신고 내역 조회
- 신고 상세 정보 및 첨부 파일 확인
- 상담 진행 상태 관리

#### 3.2.2 상담 응답 시스템
- 신고에 대한 법적 조언 작성
- 권장 조치사항 제시
- 필요시 추가 자료 요청
- 상담 완료 처리

### 3.3 신고자 인터페이스 개선

#### 3.3.1 신고 상세 페이지 확장
- 변호사 배정 정보 표시
- 변호사 상담 진행 상황 실시간 업데이트
- 변호사 응답 내용 확인
- 추가 질문이나 자료 제출 기능

#### 3.3.2 알림 시스템
- 변호사 배정 시 알림
- 변호사 응답 완료 시 알림
- 추가 자료 요청 시 알림

## 4. 기술적 구현 계획

### 4.1 Phase 1: 기존 변호사 상담 게시판 제거
- `/consult` 경로 및 관련 페이지 삭제
- 변호사 상담 관련 UI 컴포넌트 제거
- 메뉴 구조에서 변호사 상담 항목 제거
- 데이터베이스 스키마 정리

### 4.2 Phase 2: 데이터베이스 스키마 확장

#### 4.2.1 신고 테이블 확장 (reports)
```sql
ALTER TABLE reports ADD COLUMN lawyer_id INTEGER;
ALTER TABLE reports ADD COLUMN lawyer_assigned_at TIMESTAMP;
ALTER TABLE reports ADD COLUMN lawyer_consultation_started_at TIMESTAMP;
ALTER TABLE reports ADD COLUMN lawyer_response_at TIMESTAMP;
```

#### 4.2.2 변호사 상담 응답 테이블 생성
```sql
CREATE TABLE lawyer_consultations (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  report_id INTEGER NOT NULL,
  lawyer_id INTEGER NOT NULL,
  consultation_content TEXT,
  recommended_actions TEXT,
  additional_notes TEXT,
  status VARCHAR(50) DEFAULT 'assigned',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (report_id) REFERENCES reports(id),
  FOREIGN KEY (lawyer_id) REFERENCES users(id)
);
```

### 4.3 Phase 3: 백엔드 API 개발

#### 4.3.1 신고 관리 API 확장
- `POST /api/reports/:id/assign-lawyer` - 변호사 배정
- `GET /api/reports/:id/consultation` - 변호사 상담 정보 조회
- `PUT /api/reports/:id/consultation` - 변호사 상담 응답 업데이트

#### 4.3.2 변호사 전용 API
- `GET /api/lawyer/assigned-reports` - 배정된 신고 목록
- `POST /api/lawyer/consultations` - 상담 응답 작성
- `PUT /api/lawyer/consultations/:id` - 상담 응답 수정

### 4.4 Phase 4: 프론트엔드 개발

#### 4.4.1 관리자 인터페이스
- 신고 상세 페이지에 변호사 배정 기능 추가
- 변호사 목록 및 전문 분야별 필터링
- 배정 히스토리 및 통계 대시보드

#### 4.4.2 변호사 대시보드
- 배정된 신고 목록 페이지
- 신고 상세 조회 및 상담 응답 작성 인터페이스
- 상담 진행 상황 관리 도구

#### 4.4.3 신고자 인터페이스
- 신고 상세 페이지에 변호사 상담 섹션 추가
- 변호사 정보 및 상담 진행 상황 표시
- 변호사 응답 내용 표시 및 피드백 기능

## 5. 사용자 경험 (UX) 설계

### 5.1 신고자 관점

#### 5.1.1 신고 접수 후 흐름
1. 신고 접수 완료
2. 관리자 검토 (상태: reviewing)
3. 변호사 상담 필요 판단 시 변호사 배정 (상태: lawyer_assigned)
4. 변호사 상담 진행 알림 수신 (상태: lawyer_consulting)
5. 변고사 응답 완료 알림 수신 (상태: lawyer_responded)
6. 최종 해결 (상태: completed)

#### 5.1.2 신고 상세 페이지 UI
```
┌─────────────────────────────────────────────────────────┐
│ 신고 #123 - 학부모 민원 관련 건                          │
├─────────────────────────────────────────────────────────┤
│ 상태: 변호사 상담중 🟡                                   │
│ 접수일: 2024-08-27                                      │
│ 담당 변호사: 김변호사 ⭐⭐⭐⭐⭐                          │
├─────────────────────────────────────────────────────────┤
│ 📋 신고 내용                                           │
│ [신고 상세 내용]                                        │
├─────────────────────────────────────────────────────────┤
│ 💼 변호사 상담                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 상담 응답 (2024-08-28 15:30)                        │ │
│ │ [변호사의 법적 조언 내용]                            │ │
│ │                                                     │ │
│ │ 권장 조치사항:                                       │ │
│ │ - 조치 1                                           │ │
│ │ - 조치 2                                           │ │
│ └─────────────────────────────────────────────────────┘ │
│ [추가 질문하기] [자료 제출하기]                          │
└─────────────────────────────────────────────────────────┘
```

### 5.2 변호사 관점

#### 5.2.1 변호사 대시보드
```
┌─────────────────────────────────────────────────────────┐
│ 변호사 대시보드                                          │
├─────────────────────────────────────────────────────────┤
│ 📊 현황                                                │
│ • 배정된 신고: 5건                                      │
│ • 상담 대기: 2건                                        │
│ • 상담 완료: 3건                                        │
├─────────────────────────────────────────────────────────┤
│ 📋 배정된 신고 목록                                     │
│ ┌─────┬──────────────┬────────┬──────────────────┐      │
│ │ ID  │ 제목         │ 상태   │ 배정일           │      │
│ ├─────┼──────────────┼────────┼──────────────────┤      │
│ │ 123 │ 학부모 민원  │ 대기중 │ 2024-08-27      │      │
│ │ 124 │ 학생 폭언    │ 진행중 │ 2024-08-26      │      │
│ └─────┴──────────────┴────────┴──────────────────┘      │
└─────────────────────────────────────────────────────────┘
```

### 5.3 관리자 관점

#### 5.3.1 신고 관리 인터페이스
- 신고 목록에서 변호사 배정 필요 여부 쉽게 판단
- 변호사별 업무량 및 전문 분야 고려한 배정 도구
- 상담 진행 상황 모니터링 대시보드

## 6. 구현 우선순위

### 6.1 High Priority (1-2주)
1. **기존 변호사 상담 게시판 제거**
   - UI에서 메뉴 및 페이지 제거
   - 라우팅 및 API 엔드포인트 정리
   - 데이터베이스 스키마 정리

2. **데이터베이스 스키마 확장**
   - reports 테이블 컬럼 추가
   - lawyer_consultations 테이블 생성
   - 마이그레이션 스크립트 작성

### 6.2 Medium Priority (3-4주)
3. **백엔드 API 개발**
   - 변호사 배정 API
   - 상담 응답 관리 API
   - 알림 시스템 구현

4. **관리자 인터페이스 개발**
   - 변호사 배정 기능
   - 상담 진행 모니터링

### 6.3 Low Priority (5-6주)
5. **변고사 대시보드 개발**
   - 배정된 신고 목록
   - 상담 응답 인터페이스

6. **신고자 인터페이스 개선**
   - 변호사 상담 섹션 추가
   - 실시간 상태 업데이트

## 7. 예상 효과

### 7.1 긍정적 효과
- **사용자 경험 개선**: 신고와 상담이 하나의 플로우로 연결되어 직관적
- **시스템 단순화**: 독립적인 상담 게시판 제거로 복잡성 감소
- **업무 효율성 향상**: 신고 처리 과정에 변호사 상담이 자연스럽게 통합
- **추적 가능성**: 신고부터 해결까지 전체 과정을 하나의 케이스로 관리

### 7.2 개선된 워크플로우
```
신고자: 신고 접수 → 상황 모니터링 → 변호사 상담 확인 → 문제 해결
관리자: 신고 검토 → 변호사 배정 → 진행 상황 모니터링 → 최종 처리
변호사: 배정 알림 → 케이스 검토 → 법적 조언 제공 → 상담 완료
```

## 8. 리스크 및 완화 방안

### 8.1 리스크
- **기존 변호사 상담 데이터 손실**: 독립적인 상담 내역이 삭제될 수 있음
- **변호사 업무 프로세스 변경**: 기존 상담 방식에서 신고 기반 상담으로 전환
- **사용자 적응**: 새로운 통합 인터페이스에 대한 학습 필요

### 8.2 완화 방안
- **데이터 마이그레이션**: 기존 상담 데이터를 신고 시스템으로 마이그레이션
- **단계적 전환**: 기존 시스템을 유지하면서 새로운 시스템 병행 운영 후 전환
- **사용자 가이드**: 새로운 프로세스에 대한 상세한 사용자 매뉴얼 제공
- **교육 및 지원**: 변호사 및 관리자 대상 새로운 시스템 교육

## 9. 성공 기준

### 9.1 기능적 성공 기준
- [ ] 기존 변호사 상담 게시판이 완전히 제거됨
- [ ] 신고 시스템에 변호사 상담 기능이 완전히 통합됨
- [ ] 변호사 배정 및 상담 응답 기능이 정상 동작함
- [ ] 신고자가 변호사 상담 진행 상황을 실시간으로 확인 가능함

### 9.2 사용자 경험 성공 기준
- [ ] 신고부터 변호사 상담까지의 프로세스가 직관적으로 연결됨
- [ ] 변호사가 배정된 신고를 효율적으로 관리할 수 있음
- [ ] 관리자가 변고사 배정 및 상담 진행을 쉽게 모니터링할 수 있음
- [ ] 전체적인 사용자 만족도가 개선됨

### 9.3 기술적 성공 기준
- [ ] 시스템 빌드 및 테스트가 모두 통과함
- [ ] 데이터베이스 마이그레이션이 성공적으로 완료됨
- [ ] 새로운 API가 안정적으로 동작함
- [ ] 전체 시스템 성능이 유지되거나 개선됨

## 10. 결론

변호사 상담 게시판을 신고 접수 시스템에 통합함으로써, 교권119 시스템은 더욱 직관적이고 효율적인 서비스로 발전할 수 있을 것입니다. 이를 통해 신고자는 하나의 일관된 프로세스를 통해 문제 해결을 받을 수 있고, 변호사는 더욱 체계적으로 상담 업무를 수행할 수 있으며, 관리자는 전체 케이스를 통합적으로 관리할 수 있게 됩니다.

단계적 구현을 통해 기존 시스템의 안정성을 유지하면서 새로운 기능을 안전하게 도입하여, 궁극적으로 더 나은 사용자 경험과 시스템 효율성을 달성할 수 있을 것으로 기대됩니다.